<nav>
    <header class="header bg-base-300" *ngIf="user$ | async as user">
        <a
            class="btn btn-ghost btn-circle btn-sm mr-1"
            routerLink=""
        >
            <i class="fas fa-home"></i>
        </a>

        <div class="spacer"></div>

        <div style="min-width: 400px;">
            <input
                type="text"
                class="input-bordered input-ghost w-full"
                amInput
                placeholder="Найти заметку"
                #searchNoteInput
                [formControl]="control"
                [amMenuTrigger]="menu"
            >

            <am-menu-panel #menu="amMenu" >
                <div [style.width]="searchNoteInput.offsetWidth + 'px'">
                    <ng-container *ngIf="filteredNotes$ | async as notes">
                        <am-option *ngIf="!notes.length">Нет заметок</am-option>
                        <am-option *ngFor="let note of filteredNotes$ | async" (click)="checkNote(note)">
                            <span class="truncate">{{note.title}}</span>
                        </am-option>
                    </ng-container>
                </div>
            </am-menu-panel>
        </div>

        <div class="spacer"></div>

        <button
            class="btn btn-ghost btn-circle btn-sm mr-1"
            [amMenuTrigger]="themeMenu"
        >
            <i class="fas fa-palette"></i>
        </button>

        <div class="controls" *ngIf="!user.token; else userControl">
            <a class="btn btn-primary btn-sm" routerLink="auth/signup">Sign up</a>
            <div class="divider divider-vertical"></div>
            <a class="btn btn-accent btn-sm" routerLink="auth/login">Log in</a>
        </div>

        <ng-template #userControl>
            <button class="btn btn-circle btn-sm btn-ghost" [amMenuTrigger]="userMenu">
                <i class="fas fa-user"></i>
            </button>

            <am-menu-panel #userMenu="amMenu">
                <li>
                    <a>
                        <span class="inline-block w-6 h-6 mr-2 stroke-current">
                            <i class="fas fa-envelope-open-text"></i>
                        </span>
                        {{user.email}}
                    </a>
                </li>
                <li>
                    <a>
                        <span class="inline-block w-6 h-6 mr-2 stroke-current">
                            <i class="fas fa-id-card-alt"></i>
                        </span>
                        {{user.name}}
                    </a>
                </li>
                <li>
                    <a routerLink="auth/login">
                        <span class="inline-block w-6 h-6 mr-2 stroke-current">
                            <i class="fas fa-moon"></i>
                        </span>
                        Sign out
                    </a>
                </li>
            </am-menu-panel>
        </ng-template>

    </header>
</nav>


<am-menu-panel #themeMenu="amMenu">
    <li>
        <a (click)="setTheme('light')">
            <span class="inline-block w-6 h-6 mr-2 stroke-current">
                <i class="fas fa-sun"></i>
            </span>
            Light
        </a>
    </li>
    <li>
        <a (click)="setTheme('dark')">
            <span class="inline-block w-6 h-6 mr-2 stroke-current">
                <i class="fas fa-moon"></i>
            </span>
            Dark
        </a>
    </li>
</am-menu-panel>
